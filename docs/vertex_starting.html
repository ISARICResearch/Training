<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Getting Started with VERTEX</title>

<style>
    body {
        display: flex;
        font-family: Arial, sans-serif;
        margin: 0;
        overflow-x: hidden;
    }
    .sidebar {
        width: 250px;
        background-color: #f4f4f4;
        padding: 15px;
        box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        height: 100vh;
        position: fixed;
        overflow-y: auto;
    }
    .content {
        margin-left: 270px;
        padding: 20px;
        max-width: 900px;
    }
    .content h1, .content h2, .content h3 {
        margin-top: 40px;
    }
    .content p, .content img {
        max-width: 100%;
    }
    pre {
        background-color: #2d2d2d;
        color: #f8f8f2;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
    }
    code {
        color: #f8f8f2;
    }
    .sidebar a {
        display: block;
        padding: 10px;
        color: #333;
        text-decoration: none;
        margin-bottom: 5px;
        border-radius: 5px;
    }
    .sidebar a:hover {
        background-color: #ddd;
    }
    .footer {
        background-color: #f4f4f4;
        text-align: center;
        padding: 15px;
        box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        margin-top: auto; /* Push the footer to the bottom */
    }
</style>
</head>

<body>
<div class="sidebar">
    <h2><a href="https://isaricresearch.github.io/Training/">Home</a></h2>
    <div style="padding-left:10px">
        <h2>Contents</h2>
        <a href="#purpose">Purpose</a>
        <a href="#introduction">Introduction</a>
        <a href="#installation-usage">Installation and usage</a>
        <a href="#dashboard">VERTEX dashboard</a>
        <a href="#next_steps">Next steps</a>
    </div>
    </div>
    <div class="content">

    <h1 id="getting_started">Getting Started with VERTEX</h1>

    <h2 id="purpose">Purpose</h2>

    <p>This guide provides a brief introduction to the Visual Evidence & Research Tool for Exploration (VERTEX) dashboard and the Reusable Analytical Pipelines for Infectious Diseases (RAPID) code framework. It provides instructions for how to run the base VERTEX software on your local machine.</p>

    <h2 id="introduction">Introduction</h2>

    <p>VERTEX is a web-based Python<sup>1</sup> application that presents graphs and tables relating to research questions that need to be quickly answered during an outbreak. This helps identification of key epidemiological factors and supports data-driven decision-making.</p>

    <img src="https://github.com/ISARICResearch/Training/raw/main/docs/assets/vertex_starting-insight-panel.png" alt="VERTEX">

    <p>VERTEX is open-source, which means that you can access and download the codebase from GitHub<sup>2</sup>, and create new analysis projects for your analysis. At the moment, the VERTEX dashboard can display two types of projects.</p>

    <p><strong>Analysis projects</strong> retrieve data from a REDCap database using the API, preprocess this patient-level data<sup>3</sup> and execute analysis code to answer research questions from a statistical analysis plan. The output of this analysis code is a series of figures and tables, which are presented in the dashboard, grouped together in <strong>insight panels</strong>.</p>

    <p>For structuring analysis code, we borrow a concept called Reproducible Analytical Pipelines<sup>4</sup>. This is intended to make analysis reproducible, efficient and auditable. We extend this concept to <strong>Reusable Analytical Pipelines for Infectious Diseases (RAPIDs)</strong><sup>5</sup>, which supports the transportation of these pipelines to answer the similar research questions in similar contexts.</p>

    <p><strong>Static projects</strong> do not execute the analysis pipelines, but reproduce the figures and tables directly from aggregated (not patient-level) data files<sup>6</sup>. These files can be provided directly or can be automatically created when the users runs an analysis project.</p>

    <p><small>
        <sup>1</sup>We have had feedback from some users that they use R as a programming language and are not very familiar with Python. We acknowledge this tool will not be easy to use if you are only an R user. Unfortunately we are not able to support integration of R code at the moment, but we will revisit this when we can. We can help to support your analysis in the meantime.
        <br>
        <sup>2</sup><a href="https://github.com/ISARICResearch/VERTEX/blob/main/README.md">https://github.com/ISARICResearch/VERTEX/blob/main/README.md</a>
        <br>
        <sup>3</sup>We must make some assumptions about the structure of the REDCap project and a core subset of the variables within the data, which are described later in this guide.
        <br>
        <sup>4</sup><a href="https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/">https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/</a>
        <br>
        <sup>5</sup>We are currently developing a standalone package to support the development of RAPIDs. This is intended to make development of pipelines more user-friendly and to include more detailed documentation and testing. Users will initially be able to customise or develop analysis code outside of the VERTEX dashboard, but can still integrate the outputs within the dashboard.
        <br>
        <sup>6</sup>Each type of figure requires aggregated data in a specific structure, with accompanying metadata to provide other input parameters. We are currently refining this, so we do not have up-to-date documentation about each figure type. However, we can support this if you have aggregated data and you want to present results within a dashboard.
    </small></p>

    <h2 id="installation-usage">Installation and usage</h2>

    <p>To use VERTEX locally, clone the VERTEX GitHub repository<sup>7</sup> and make sure that you have <samp>Python</samp> installed. There are several ways to run the VERTEX code, and depending on how your preferences for coding, you may also find it useful to have the following installed: git, Docker and VSCode.</p>

    <p>We will demonstrate how to run the code at the command line using Docker and in VSCode without Docker, though we recommend using Docker if possible<sup>8</sup>.</p>

    <h3 id="docker">Docker at the command line</h3>

    <p>On the command line, navigate to the repository. Depending on how you cloned the repository, this may be in your Downloads folder or in the current working directory.</p>

    <p>We recommend using Docker if you want to run VERTEX at the command line. You can build and run a Docker container for VERTEX with the following:</p>

    <pre><code>docker build -t isaric-vertex .
    <br>docker run -it --rm -v "$PWD":/app -p 8050:8050 isaric-vertex gunicorn --workers 1 --reload --bind 0.0.0.0:8050 vertex.descriptive_dashboard:server</code></pre>

    <h3 id="docker">VSCode without Docker</h3>

    <p>Open the VERTEX folder within VSCode. You need to create an environment<sup>9</sup> from the VERTEX requirements. The simplest way to do this is <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>p</kbd> (or <kbd>Command</kbd> + <kbd>Shift</kbd> + <kbd>p</kbd> on MacOS), then click "Python: Create environment...", ".venv" and choose a Python version that is >3.9. This will install a virtual environment using the requirements listed in <samp>pyproject.toml</samp>.</p>

    <p>Next, you need to add a file <samp>.vscode/launch.json</samp> with the following:

    <pre><code>
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "ISARIC VERTEX",
      "type": "python",
      "request": "launch",
      "module": "vertex.descriptive_dashboard",
      "justMyCode": false,
      "env": {
        "PYTHONPATH": "${workspaceFolder}"
      }
    }
  ]
}
    </code></pre>

    <p>You should now be able to run the application in debugging mode ("Run &rarr; Start Debugging") or without debugging ("Run &rarr; Run Without Debugging").</p>

    <p><small>
        <sup>7</sup><a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository">https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository</a>
        <br>
        <sup>8</sup>See <a href="https://code.visualstudio.com/docs/containers/overview">https://code.visualstudio.com/docs/containers/overview</a> for using Docker within VSCode.
        <br>
        <sup>9</sup><a href="https://code.visualstudio.com/docs/python/environments">https://code.visualstudio.com/docs/python/environments</a>
    </small></p>

    <h2 href="#dashboard">VERTEX dashboard</h2>

    <p>Once the application is running at the terminal or in VSCode, you will be able to open the local VERTEX dashboard at http://127.0.0.1:8050. You will see a menu on the left, and a world map with a colorbar.</p>

    <img src="https://github.com/ISARICResearch/Training/raw/main/docs/assets/vertex_starting-dashboard.png" alt="VERTEX dashboard">

    <p>At the top of the menu is listed the current open project. You can switch between active projects using the dropdown immediately below. The current active projects are <strong>analysis projects</strong> that use low-fidelity synthetic datasets and <strong>static projects</strong> showing the results from completed ISARIC analyses.</p>

    <p>The map shows the number of participants that were enrolled in this project by country. You can hover over each country for a more precise count of the number of participants.</p>

    <p>Below the project selection box in the menu are a set of tabs, which are mostly specific to the selected project. <strong>Analysis projects</strong>, which retrieve the up-to-date patient-level data from a REDCap database and directly execute analysis code, have a tab called <strong>Filters and Controls</strong>. If you click on this, it will open up to show
    a set of core variables: sex at birth, age, country, admission date and outcome. You can select different combinations, which will filter the patient-level data and update the map accordingly.</p>

    <p>For all projects, the remaining tabs should each be relevant to a research question or a moment/event in the patient's journey. Each tab can be expanded to show one or more buttons, which may break this down further into group of related variables e.g. demographics and comorbidities. Each button will then open an object called an <strong>insight panel</strong>.</p>

    <p>Insight panels show the outputs of an analysis pipeline. At this time, this will mostly involve descriptive tables and summary figures displaying counts or proportions. We will continue to add new analyses as we build a larger collection of RAPIDs. As with the base page, <strong>analysis projects</strong> will have a tab for <strong>Filters and Controls</strong> and the code will be executed again if you filter the participants. This is not possible for <strong>static projects</strong>, which display fixed outputs.</p>

    <img src="https://github.com/ISARICResearch/Training/raw/main/docs/assets/vertex_starting-insight-panel.png" alt="Insight panels">

    <h2 id="next_steps">Next steps</h2>

    <p>This guide has introduced VERTEX and how to run the code locally.</p>

    <p>VERTEX is intended to run multiple projects. If you have REDCap database that was created using ISARIC BRIDGE and have API access for your database, then you should be able add a new project to your local VERTEX and display outputs from your analysis in a similar manner to the existing projects.</p>

    <p>For more detailed guides in creating new projects in VERTEX and developing new RAPIDs, please refer to the following guides: <a href="https://isaricresearch.github.io/Training/insight_panel.html">Creating a new VERTEX project</a> and <a href="https://isaricresearch.github.io/Training/insight_panel.html">Creating a new insight panel</a>.</p>

    <div class="footer">
        <p>Licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Commons Attribution-ShareAlike 4.0</a> International License by  <a href="https://isaric.org/" target="_blank">ISARIC</a> on behalf of Oxford University.</p>
    </div>
</body>
</html>
